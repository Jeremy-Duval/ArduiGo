<project name="EJB" default="deploy">
	<property file="ejb-build.properties" />
	<property name="src.dir" location="${srcdir}" />
	<property name="metainf.dir" location="META-INF" />
	<property name="build.dir" location="build" />
	<property name="classes.dir" location="${build.dir}/classes" />
	<property name="jar.name" value="EJB.jar" />
	<property name="clientjar.name" value="EJB_client.jar" />
	<property name="jar.file" location="${build.dir}/${jar.name}" />
	<property name="deploy.dir" location="C:\samples\EJB\deploy" />
	<property name="clientjar.dir" location="C:\samples\EJB" />
	<property name="j2eeapi.file" location="C:\applications\eclipse_sample\sde\bundled\j2ee-api.jar" />
	<property name="datasource.name" value="shop-ds.xml" />
	<property name="datasource.file" location="${datasource.name}" />

	<target name="deploy" depends="jar, clientjar">
		<copy todir="${deploy.dir}" file="${jar.file}" />
		<copy todir="${deploy.dir}" file="${datasource.file}" />
		<copy todir="${clientjar.dir}" file="${build.dir}/${clientjar.name}" />
	</target>

	<target name="undeploy">
		<delete file="${deploy.dir}/${jar.name}" />
		<delete file="${deploy.dir}/${datasource.name}" />
	</target>

	<target name="jar" depends="compile">
		<jar destfile="${jar.file}">
			<fileset dir="${classes.dir}">
			</fileset>
			<zipfileset dir="${metainf.dir}" prefix="META-INF">
			</zipfileset>
		</jar>
	</target>

	<target name="clientjar" depends="compile">
		<jar destfile="${build.dir}/${clientjar.name}">
			<fileset dir="${classes.dir}">
				<include name="shop/Cart.class" />
				<include name="shop/CartHome.class" />
				<include name="shop/Item.class" />
				<include name="shop/ItemHome.class" />
			</fileset>
		</jar>
	</target>

	<target name="compile">
		<mkdir dir="${build.dir}" />
		<mkdir dir="${classes.dir}" />
		<javac srcdir="${src.dir}" destdir="${classes.dir}" source="1.3" target="1.2">
			<classpath location="${j2eeapi.file}" />
		</javac>
		<copy todir="${classes.dir}">
			<fileset dir="${src.dir}">
				<exclude name="**/*.java" />
			</fileset>
		</copy>
	</target>

	<target name="clean">
		<delete dir="${build.dir}" />
	</target>

</project>
